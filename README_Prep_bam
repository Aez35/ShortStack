SYNOPSIS
    Input a sam, sam.gz, or bam file sorted by read names, Tally mappings
    per read and note with NH:i: tags, Output a .bam file sorted by
    chromosomal location, and a corresponding .bai index file.

VERSIONS
    0.1.1 : THIS VERSION. June 28, 2012. Frist released with ShortStack
    0.1.4. Fixes program so it no longer breaks when unmapped lines are
    encountered (now it simply ignores them). This also allows direct piping
    of bowtie data directly into Prep_bam.pl

    0.1.0 : Initial release. April 29, 2012

INSTALL
    install samtools from <http://samtools.sourceforge.net/> and ensure that
    samtools is in your PATH

    ensure the script is executable

        chmod +x Prep_bam.pl                                                         
                                                                                                 
    ensure the script is in your PATH (examples):

        sudo cp Prep_bam.pl /usr/bin/                                                
                                                                                                 
    OR just for one session assuming script is in your working directory:

        PATH=$PATH:.                                                                                 
                                                                                                 
    ensure 'perl' is located in /usr/bin/ .. if not, edit line 1 of script
    accordingly

USAGE
    1. For .bam files:

        samtools view [input.bam] | Prep_bam.pl --prefix [prefix] --genome [genome.fasta]                                  

    2. For .sam.gz files:

        gzip -d -c [input.sam.gz] | Prep_bam.pl --prefix [prefix] --genome [genome.fasta]                          

    3. For uncompressed .sam files:

        Prep_bam.pl --prefix [prefix] --genome [genome.fasta] < [input.sam]     

    4. To pipe in bowtie (version 1 e.g. 0.12.8) sam output directly:

        bowtie [bowtie_options] -S [bowtie_index] [trimmed_reads] | Prep_bam.pl --prefix [prefix] --genome [genome] 

OPTIONS
    -- prefix [string] : base name for the final .bam and .bam.bai files
    that will be created

    -- genome [string] : Path to the fasta formatted genome file used for
    the mapping

NOTES
  Input format and assumptions

    It is critical that the input sam, sam.gz, or bam file be sorted by read
    name. Additionally, it is assumed that read names are unique within the
    file. If either of these assumptions are not true, the results of this
    script are not reliable.

  Exisiting NH:i: tags

    If there are already NH:i: tags in the input data, they will be
    discarded and over-written by the script.

AUTHOR
    Michael J. Axtell, Penn State University, mja18@psu.edu

